# ADB-Kit Technical Spike ç»éªŒæ€»ç»“

> **æ—¥æœŸ:** 2026-02-01
> **é¡¹ç›®:** ATV-Scheduler-CLI
> **éªŒè¯è®¾å¤‡:** MiTV-MFTR0 (å°ç±³ç”µè§†), Android 11

## æ¦‚è¿°

åœ¨å®æ–½ ATV-Scheduler-CLI é¡¹ç›®å‰ï¼Œé€šè¿‡ Technical Spike éªŒè¯äº†æ ¸å¿ƒæŠ€æœ¯å‡è®¾ã€‚æœ¬æ–‡æ¡£è®°å½•å‘ç°çš„é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆï¼Œä¾›åç»­é¡¹ç›®å‚è€ƒã€‚

---

## é—®é¢˜ 1: npm åŒ…åé”™è¯¯

### ç°è±¡

```bash
npm install adb-kit
# Error: 404 Not Found - 'adb-kit@^3.2.6' is not in this registry
```

### åŸå› 

- åŸå§‹åŒ… `adb-kit` å·²ä» npm registry ç§»é™¤æˆ–æ”¹å
- ç½‘ä¸Šå¾ˆå¤šæ•™ç¨‹å’Œæ–‡æ¡£ä»ç„¶å¼•ç”¨æ—§åŒ…å

### è§£å†³æ–¹æ¡ˆ

ä½¿ç”¨ `@devicefarmer/adbkit` æ›¿ä»£ï¼š

```bash
npm install @devicefarmer/adbkit
```

### ç»éªŒ

- åœ¨åˆ¶å®šæŠ€æœ¯æ–¹æ¡ˆå‰ï¼Œå…ˆéªŒè¯ä¾èµ–åŒ…æ˜¯å¦å¯ç”¨
- ä¼˜å…ˆé€‰æ‹©æœ‰ç»„ç»‡ç»´æŠ¤çš„ scoped åŒ…ï¼ˆå¦‚ `@devicefarmer/`ï¼‰
- æ£€æŸ¥åŒ…çš„æœ€åæ›´æ–°æ—¶é—´å’Œç»´æŠ¤çŠ¶æ€

---

## é—®é¢˜ 2: æ¨¡å—å¯¼å…¥æ–¹å¼å·®å¼‚

### ç°è±¡

```javascript
// æ–‡æ¡£ä¸­çš„å†™æ³•ï¼ˆé”™è¯¯ï¼‰
import Adb from 'adb-kit';
const client = Adb.createClient();

// å®é™…è¿è¡ŒæŠ¥é”™
// TypeError: Adb.createClient is not a function
```

### åŸå› 

`@devicefarmer/adbkit` çš„æ¨¡å—ç»“æ„ä¸æ—§ç‰ˆä¸åŒï¼š

```javascript
// æ¨¡å—ç»“æ„
{
  default: {
    Adb: [class Adb],
    Parser: ...,
    Client: ...,
    // ...
  }
}
```

### è§£å†³æ–¹æ¡ˆ

```javascript
// æ­£ç¡®çš„å¯¼å…¥æ–¹å¼
import AdbKit from '@devicefarmer/adbkit';
const Adb = AdbKit.Adb;
const client = Adb.createClient();
```

### ç»éªŒ

- ä¸è¦å‡è®¾åŒ…çš„ API ä¸æ–‡æ¡£ä¸€è‡´ï¼Œå…ˆå†™æµ‹è¯•éªŒè¯
- ä½¿ç”¨ `console.log(Object.keys(module))` æ£€æŸ¥æ¨¡å—ç»“æ„
- ESM å’Œ CommonJS çš„å¯¼å‡ºæ–¹å¼å¯èƒ½ä¸åŒ

---

## é—®é¢˜ 3: API è°ƒç”¨æ–¹å¼å˜æ›´

### ç°è±¡

```javascript
// æ—§ APIï¼ˆé”™è¯¯ï¼‰
await client.shell('192.168.0.145:5555', 'echo hello');
// TypeError: client.shell is not a function
```

### åŸå› 

æ–°ç‰ˆ API é‡‡ç”¨è®¾å¤‡å¯¹è±¡æ¨¡å¼ï¼Œè€Œéç›´æ¥åœ¨ client ä¸Šè°ƒç”¨ï¼š

```javascript
// Client æ–¹æ³•
['connect', 'disconnect', 'listDevices', 'getDevice', ...]

// Device æ–¹æ³•
['shell', 'reboot', 'install', 'push', 'pull', ...]
```

### è§£å†³æ–¹æ¡ˆ

```javascript
// æ­£ç¡®çš„ API è°ƒç”¨
const device = client.getDevice('192.168.0.145:5555');
const stream = await device.shell('echo hello');
```

### ç»éªŒ

- API è®¾è®¡æ¨¡å¼å¯èƒ½éšç‰ˆæœ¬å˜åŒ–ï¼ˆä»æ‰å¹³åˆ°åˆ†å±‚ï¼‰
- å…ˆåˆ—å‡ºå¯ç”¨æ–¹æ³•å†ç¼–å†™ä¸šåŠ¡ä»£ç 
- ä¿æŒæµ‹è¯•ä»£ç ä¸å®ç°ä»£ç åŒæ­¥æ›´æ–°

---

## é—®é¢˜ 4: Android TV åº”ç”¨å¯åŠ¨æ–¹å¼

### ç°è±¡

```bash
# è®¡åˆ’ä¸­çš„å¯åŠ¨æ–¹å¼ï¼ˆä¸å¯é ï¼‰
am start -n com.google.android.youtube.tv/.Main
# é—®é¢˜ï¼šä¸åŒè®¾å¤‡/ç‰ˆæœ¬çš„ Activity åç§°ä¸åŒ
```

### åŸå› 

- Android TV åº”ç”¨çš„ä¸» Activity åç§°ä¸ç»Ÿä¸€
- ç”¨æˆ·å¯èƒ½å®‰è£…ç¬¬ä¸‰æ–¹ YouTube å®¢æˆ·ç«¯ï¼ˆå¦‚ SmartTubeï¼‰
- åŒ…åå’Œ Activity åç§°å¯èƒ½éšç‰ˆæœ¬å˜åŒ–

### è§£å†³æ–¹æ¡ˆ

ä½¿ç”¨ VIEW intent è®©ç³»ç»Ÿé€‰æ‹©åˆé€‚çš„åº”ç”¨ï¼š

```bash
# æ¨èæ–¹å¼
am start -a android.intent.action.VIEW -d "https://www.youtube.com/watch?v=VIDEO_ID"
```

### ä¼˜åŠ¿

| æ–¹å¼ | ä¼˜ç‚¹ | ç¼ºç‚¹ |
|------|------|------|
| æŒ‡å®šåŒ…å | ç²¾ç¡®æ§åˆ¶ | éœ€è¦çŸ¥é“ç¡®åˆ‡çš„ Activity |
| VIEW intent | é€šç”¨ã€çµæ´» | å¯èƒ½å¼¹å‡ºé€‰æ‹©å™¨ |

### ç»éªŒ

- ä¼˜å…ˆä½¿ç”¨ç³»ç»Ÿçº§ intent è€Œéç¡¬ç¼–ç åŒ…å
- åœ¨çœŸå®è®¾å¤‡ä¸ŠéªŒè¯å‘½ä»¤ï¼Œä¸è¦åªä¾èµ–æ–‡æ¡£
- è€ƒè™‘ç”¨æˆ·å¯èƒ½ä½¿ç”¨çš„æ›¿ä»£åº”ç”¨

---

## Technical Spike æœ€ä½³å®è·µ

### 1. Spike ç›®å½•ç»“æ„

```
spike/
â”œâ”€â”€ package.json          # ç‹¬ç«‹çš„ä¾èµ–é…ç½®
â”œâ”€â”€ config.mjs            # å¯é…ç½®çš„æµ‹è¯•å‚æ•°
â”œâ”€â”€ 01-test-xxx.mjs       # æŒ‰é¡ºåºç¼–å·çš„æµ‹è¯•è„šæœ¬
â”œâ”€â”€ 02-test-xxx.mjs
â””â”€â”€ CHECKLIST.md          # éªŒè¯æ¸…å•
```

### 2. éªŒè¯é¡ºåº

```
ä¾èµ–å®‰è£… â†’ åŸºç¡€è¿æ¥ â†’ æ ¸å¿ƒåŠŸèƒ½ â†’ ä¸šåŠ¡åœºæ™¯
```

### 3. é˜»å¡çº§åˆ«åˆ†ç±»

| çº§åˆ« | å«ä¹‰ | å¤„ç†æ–¹å¼ |
|------|------|----------|
| ğŸ”´ é˜»å¡ | å¤±è´¥åˆ™æ— æ³•ç»§ç»­ | å¿…é¡»è§£å†³åå†å®æ–½ |
| ğŸŸ¡ å¯ç»•è¿‡ | æœ‰æ›¿ä»£æ–¹æ¡ˆ | è®°å½•å¹¶è°ƒæ•´è®¡åˆ’ |
| ğŸŸ¢ ä½é£é™© | å‡ ä¹ä¸ä¼šå¤±è´¥ | å¯åœ¨å®æ–½ä¸­éªŒè¯ |

### 4. æ–‡æ¡£æ›´æ–°

Spike å®Œæˆåï¼Œå¿…é¡»æ›´æ–°å®æ–½è®¡åˆ’ï¼š
- ä¿®æ­£é”™è¯¯çš„å‡è®¾
- æ·»åŠ å‘ç°çš„æ³¨æ„äº‹é¡¹
- æ›´æ–°ä»£ç ç¤ºä¾‹

---

## ç›¸å…³æ–‡ä»¶

- Spike ä»£ç : `spike/`
- å®æ–½è®¡åˆ’: `docs/plans/2026-02-01-atv-scheduler-cli.md`
- æœ¬ç»éªŒæ–‡æ¡£: `docs/memory/2026-02-01-adb-kit-spike-lessons.md`
